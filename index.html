<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Inventaire Pause Burger</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg: #f6f6f6;
      --card: #ffffff;
      --accent: #ff7a00;
      --accent-dark: #e06600;
      --text: #111;
      --muted: #666;
      --border: #ddd;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    header {
      position: sticky;
      top: 0;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #111;
      padding: 10px 14px;
      color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      z-index: 20;
    }

    header img {
      height: 45px;
      width: auto;
      border-radius: 6px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
    }

    .title {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: .05em;
      text-transform: uppercase;
    }

    .subtitle {
      font-size: 12px;
      color: #ccc;
    }

    main {
      padding: 12px;
      padding-bottom: 100px;
      max-width: 900px;
      margin: 0 auto;
    }

    .toolbar {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 14px;
      font-weight: 600;
      background: var(--accent);
      color: white;
    }

    .btn-secondary {
      background: white;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .category {
      margin-bottom: 18px;
    }

    .category-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: .04em;
    }

    .item {
      background: var(--card);
      border-radius: 10px;
      padding: 10px;
      border: 1px solid var(--border);
      margin-bottom: 6px;
    }

    .item-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .item-name {
      font-size: 15px;
      font-weight: 600;
      flex: 1;
    }

    input[type=number] {
      width: 70px;
      padding: 6px;
      font-size: 14px;
      border-radius: 999px;
      border: 1px solid var(--border);
      text-align: center;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fafafa;
      font-size: 12px;
    }

    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 900px;
      margin: 0 auto;
      padding: 12px;
      background: #111;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .footer .count {
      font-size: 14px;
    }

    .btn-white {
      border-radius: 999px;
      padding: 8px 12px;
      border: 1px solid white;
      background: transparent;
      color: white;
      font-size: 12px;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      padding: 20px;
      z-index: 100;
    }

    .modal.open {
      display: flex;
    }

    .modal-box {
      background: white;
      border-radius: 10px;
      width: 100%;
      max-width: 500px;
      max-height: 80vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .modal-header {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      display: flex;
      justify-content: space-between;
    }

    .modal-body {
      padding: 12px;
      overflow-y: auto;
      font-size: 14px;
    }

    .modal-item {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px dashed #ddd;
      padding: 4px 0;
    }

  </style>
</head>

<body>
<header>
  <img src="IMG_0100.jpeg" alt="Logo">
  <div class="title-block">
    <div class="title">Pause Burger</div>
    <div class="subtitle">Inventaire</div>
  </div>
</header>

<main>
  <div class="toolbar">
    <button class="btn" id="showList">Voir à commander</button>
    <button class="btn btn-secondary" id="resetBtn">Réinitialiser</button>
  </div>

  <div id="categories"></div>
</main>

<div class="footer">
  <div class="count"><span id="count">0</span> articles</div>
  <button class="btn-white" id="shareBtn">Partager</button>
</div>

<div class="modal" id="modal">
  <div class="modal-box">
    <div class="modal-header">
      <b>Liste à commander</b>
      <button class="btn btn-secondary" id="closeModal">Fermer</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<script>
const DATA = {
  "Frites": ["Frites"],

  "Crudités": [
    "Salade", "Tomates", "Oignons", "Cornichons"
  ],

  "Produits frais / congélation (viandes)": [
    "Steak 90g","Steak 45g","Cordons-bleus","Nuggets",
    "Kebab","Fricadelles","Mexicano","Merguez",
    "Chorizo","Lardons","Wings","Wings épicé"
  ],

  "Épices": [
    "Épices tenders","Épices jaune","Farine"
  ],

  "Pains": [
    "Pain sésame","Pain brioché","Petit pain","Pain toast",
    "Pain rouge","Pain noir","Pain peluche"
  ],

  "Galettes": [
    "Galette tacos grande","Galette tacos petite"
  ],

  "Sauces": [
    "Mayo","Biggy","Giant","Ketchup","Hannibal",
    "Algérienne","Samouraï","Barbecue","Sauce américaine",
    "Sauce pita","Sauce oignons","Sauce poivrons",
    "Andalouse","Brazil"
  ],

  "Huile": ["Huile"],

  "Emballages & boîtes": [
    "Emballage grand burger","Emballage petit burger",
    "Emballage tacos","Emballage wrap",
    "Sac frites grands","Sac frites petits",
    "Boîte tenders x3","Boîte tenders x7",
    "Boîte tenders x14","Boîte tenders x20"
  ],

  "Produits ménagers": [
    "Liquide vaisselle","Sac-poubelle","Eau de javel",
    "Dégraissant","Nettoyant sol","Éponge",
    "Lave inox","Serpillière"
  ]
};

function slug(s){
  return s.toLowerCase().normalize("NFD")
  .replace(/[\u0300-\u036f]/g,"")
  .replace(/[^a-z0-9]+/g,"-");
}

const KEY="pb_inventory_v2";
let state = JSON.parse(localStorage.getItem(KEY) || "{}");

function save(){localStorage.setItem(KEY,JSON.stringify(state));}

function render(){
  const container=document.getElementById("categories");
  container.innerHTML="";
  Object.entries(DATA).forEach(([cat, items])=>{
    const catDiv=document.createElement("div");
    catDiv.className="category";
    catDiv.innerHTML=`<div class="category-title">${cat}</div>`;

    items.forEach(name=>{
      const id=slug(cat+"-"+name);
      if(!state[id]) state[id]={qty:"",checked:false,order:false};

      const item=document.createElement("div");
      item.className="item";

      item.innerHTML=`
        <div class="item-row">
          <div class="item-name">${name}</div>
          <input type="number" class="qty" id="q-${id}" placeholder="Qté" value="${state[id].qty}">
        </div>
        <div class="item-row">
          <label class="chip">
            <input type="checkbox" id="c-${id}" ${state[id].checked?"checked":""}> Vu
          </label>
          <label class="chip">
            <input type="checkbox" id="o-${id}" ${state[id].order?"checked":""}> À commander
          </label>
        </div>
      `;

      // events
      item.querySelector(`#q-${id}`).addEventListener("input", e=>{
        state[id].qty=e.target.value;
        save();
        updateCount();
      });

      item.querySelector(`#c-${id}`).addEventListener("change", e=>{
        state[id].checked=e.target.checked;
        save();
      });

      item.querySelector(`#o-${id}`).addEventListener("change", e=>{
        state[id].order=e.target.checked;
        save();
        updateCount();
      });

      catDiv.appendChild(item);
    });

    container.appendChild(catDiv);
  });

  updateCount();
}

function updateCount(){
  const count=Object.values(state).filter(i=>i.order).length;
  document.getElementById("count").textContent=count;
}

document.getElementById("resetBtn").onclick=()=>{
  if(confirm("Réinitialiser tout ?")){
    state={};
    save();
    render();
  }
};

document.getElementById("showList").onclick=()=>{
  const modal=document.getElementById("modal");
  const body=document.getElementById("modalBody");
  const items=Object.entries(state).filter(([id,v])=>v.order);

  if(items.length===0){
    body.innerHTML="Aucun article à commander.";
  } else {
    body.innerHTML="";
    items.forEach(([id, v])=>{
      const row=document.createElement("div");
      row.className="modal-item";
      row.innerHTML=`
        <span>${v.name}</span>
        <span><b>x ${v.qty || 1}</b></span>
      `;
      body.appendChild(row);
    });
  }

  modal.classList.add("open");
};

document.getElementById("closeModal").onclick=()=>{
  document.getElementById("modal").classList.remove("open");
};

document.getElementById("shareBtn").onclick=async()=>{
  const items=Object.values(state).filter(i=>i.order);
  let text="Liste à commander :\n\n";
  items.forEach(i=>{
    text+=`- ${i.name} x ${i.qty||1}\n`;
  });

  if(navigator.share){
    await navigator.share({text});
  } else {
    await navigator.clipboard.writeText(text);
    alert("Liste copiée !");
  }
};

render();
</script>
</body>
</html>
