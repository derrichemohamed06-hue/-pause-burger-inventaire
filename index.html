<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Inventaire Pause Burger</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --bg: #f6f6f6;
      --card: #ffffff;
      --accent: #ff7a00;
      --accent-dark: #e06600;
      --text: #111;
      --muted: #666;
      --border: #dddddd;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    header {
      position: sticky;
      top: 0;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #111;
      padding: 10px 14px;
      color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      z-index: 20;
    }

    header img {
      height: 45px;
      border-radius: 6px;
      object-fit: contain;
    }

    .title { font-size: 18px; font-weight: 700; }
    .subtitle { font-size: 12px; color: #ccc; }

    main {
      padding: 12px;
      padding-bottom: 100px;
      max-width: 900px;
      margin: 0 auto;
    }

    .toolbar { display: flex; gap: 10px; margin-bottom: 12px; }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      font-size: 14px;
      font-weight: 600;
      background: var(--accent);
      color: white;
    }

    .btn-secondary {
      background: #fff;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .category { margin-bottom: 18px; }
    .category-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 6px;
      letter-spacing: .04em;
    }

    .item {
      background: var(--card);
      border-radius: 10px;
      padding: 10px;
      border: 1px solid var(--border);
      margin-bottom: 6px;
    }

    .item-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .item-name { font-size: 15px; font-weight: 600; flex: 1; }

    input[type=number] {
      width: 70px;
      padding: 6px;
      font-size: 14px;
      border-radius: 999px;
      border: 1px solid var(--border);
      text-align: center;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fafafa;
      font-size: 12px;
    }

    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 12px;
      background: #111;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn-white {
      border-radius: 999px;
      padding: 8px 12px;
      border: 1px solid white;
      background: transparent;
      color: white;
      font-size: 12px;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      padding: 20px;
      z-index: 100;
    }

    .modal-box {
      background: white;
      border-radius: 10px;
      width: 100%;
      max-width: 520px;
      max-height: 80vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .modal-body { padding: 12px; overflow-y: auto; white-space: pre-wrap; }
  </style>
</head>

<body>

<header>
  <img src="IMG_0100.jpeg" alt="Logo">
  <div>
    <div class="title">Pause Burger</div>
    <div class="subtitle">Inventaire · Soir</div>
  </div>
</header>

<main>
  <div class="toolbar">
    <button class="btn" id="showList">Voir à commander</button>
    <button class="btn btn-secondary" id="resetBtn">Réinitialiser</button>
  </div>

  <div id="categories"></div>
</main>

<div class="footer">
  <div>
    <div><span id="count">0</span> articles à commander</div>
  </div>
  <button class="btn-white" id="shareBtn">Partager</button>
</div>

<div class="modal" id="modal">
  <div class="modal-box">
    <div style="padding:10px;border-bottom:1px solid #ddd;display:flex;justify-content:space-between;">
      <b>Liste à commander</b>
      <button class="btn btn-secondary" id="closeModal">Fermer</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
    <div style="padding:10px;border-top:1px solid #ddd;display:flex;justify-content:flex-end;">
      <button class="btn btn-secondary" id="copyBtn">Copier</button>
    </div>
  </div>
</div>

<script>
const DATA = {

  "Frites": ["Frites"],

  "Crudités": ["Salade","Tomate","Oignon","Cornichon"],

  "Viandes": [
    "Steak 90g","Steak 45g","CB",
    "Kebab","Nuggets","Fricadelle",
    "Mexicain","Poulet","Fish",
    "Merguez","Chorizo","Lardons",
    "Rösti","Wings","Wings épicé"
  ],

  "Fromages / Suppléments": [
    "Cheddar","Raclette","Chèvre",
    "Oignons frits","Mozzarella",
    "Boursin","Bacon","Œuf","Miel"
  ],

  "Sauce cheddar / fromagère": [
    "Sauce cheddar","Sauce fromagère"
  ],

  "Sauces (groupe 1)": [
    "Mayonnaise","Biggy","Giant",
    "Algérienne","Ketchup",
    "Samouraï","Barbecue"
  ],

  "Sauces (groupe 2 / autres)": [
    "Andalouse","Poivre","Pita",
    "Oignons poivrons","Américain",
    "Tasty","Smoky","Curry",
    "Fish","Cheezy","Brazil",
    "Chili Thaï","Mammouth","Harissa"
  ],

  "Galettes": [
    "Galette tacos grande",
    "Galette tacos petite"
  ],

  "Emballages": [
    "Emballage wrap",
    "Emballage tacos",
    "Emballage grand burger",
    "Emballage petit burger",
    "Boîte tenders x3",
    "Boîte tenders x7",
    "Boîte tenders x14",
    "Boîte tenders x20",
    "Grande boîte frites cheddar",
    "Petite boîte frites cheddar",
    "Petit sac frites",
    "Grand sac frites",
    "Pot de sauce"
  ],

  "Pains": [
    "Pain sésame","Pain brioché","Pain toast",
    "Petit pain","Pain noir","Pain peluche",
    "Pain rouge"
  ],

  "Épices": [
    "Farine","Épices tenders","Épice jaune",
    "Sel","Poivre"
  ],

  "Papier / Consommable": [
    "Papier cuisson","Aluminium","Sac de congélation"
  ],

  "Huile": ["Huile"],

  "Vinaigre": ["Vinaigre"],

  "Produits ménagers": [
    "Essuie-tout","Lave-sol","Eau javel","Dégraissant",
    "Serpillière","Éponge inox","Gants",
    "Sac poubelle","Lave mains"
  ]
};


const STORAGE_KEY="pb_inventory_v4";

function slug(t){
  return t.toLowerCase()
          .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
          .replace(/[^a-z0-9]+/g,"-");
}

function initialState(){
  const s={};
  Object.entries(DATA).forEach(([cat,items])=>{
    items.forEach(name=>{
      const id=slug(cat+"-"+name);
      s[id]={name,cat,qty:"",checked:false,order:false};
    });
  });
  return s;
}

function loadState(){
  try{
    const raw=localStorage.getItem(STORAGE_KEY);
    if(!raw) return initialState();
    const s=JSON.parse(raw);
    const base=initialState();
    Object.keys(base).forEach(id=>{
      if(!s[id]) s[id]=base[id];
    });
    return s;
  }catch(e){
    return initialState();
  }
}

let state=loadState();

function saveState(){
  localStorage.setItem(STORAGE_KEY,JSON.stringify(state));
}

const categoriesEl=document.getElementById("categories");
const countEl=document.getElementById("count");

function renderCategories(){
  categoriesEl.innerHTML="";
  Object.entries(DATA).forEach(([cat,items])=>{
    const block=document.createElement("div");
    block.className="category";

    const title=document.createElement("div");
    title.className="category-title";
    title.textContent=cat;

    block.appendChild(title);

    items.forEach(name=>{
      const id=slug(cat+"-"+name);
      const d=state[id];

      const card=document.createElement("div");
      card.className="item";

      const row1=document.createElement("div");
      row1.className="item-row";

      const nameEl=document.createElement("div");
      nameEl.className="item-name";
      nameEl.textContent=name;

      const qty=document.createElement("input");
      qty.type="number";
      qty.placeholder="Qté";
      qty.value=d.qty||"";
      qty.addEventListener("input",e=>{
        d.qty=e.target.value;
        saveState();
        updateCount();
      });

      row1.appendChild(nameEl);
      row1.appendChild(qty);

      const row2=document.createElement("div");
      row2.className="item-row";

      function chip(label,key){
        const c=document.createElement("label");
        c.className="chip";
        const box=document.createElement("input");
        box.type="checkbox";
        box.checked=d[key];
        box.addEventListener("change",e=>{
          d[key]=e.target.checked;
          saveState();
          updateCount();
        });
        const t=document.createElement("span");
        t.textContent=label;
        c.appendChild(box);
        c.appendChild(t);
        return c;
      }

      row2.appendChild(chip("Vu","checked"));
      row2.appendChild(chip("À commander","order"));

      card.appendChild(row1);
      card.appendChild(row2);
      block.appendChild(card);
    });

    categoriesEl.appendChild(block);
  });

  updateCount();
}

function updateCount(){
  const n=Object.values(state).filter(i=>i.order).length;
  countEl.textContent=n;
}

function buildList(){
  const selected=Object.values(state).filter(i=>i.order);
  if(selected.length===0) return "Aucun article à commander.";

  const byCat={};
  selected.forEach(it=>{
    if(!byCat[it.cat]) byCat[it.cat]=[];
    byCat[it.cat].push(it);
  });

  let txt="Liste à commander – Pause Burger\n\n";
  Object.entries(byCat).forEach(([cat,items])=>{
    txt+=`[${cat}]\n`;
    items.forEach(it=>{
      const q=it.qty&&it.qty!==""?it.qty:"1";
      txt+=`- ${it.name} x ${q}\n`;
    });
    txt+="\n";
  });

  return txt;
}

document.getElementById("resetBtn").addEventListener("click",()=>{
  if(!confirm("Tout réinitialiser ?")) return;
  state=initialState();
  saveState();
  renderCategories();
});

document.getElementById("showList").addEventListener("click",()=>{
  const modal=document.getElementById("modal");
  const body=document.getElementById("modalBody");
  body.textContent=buildList();
  modal.style.display="flex";
});

document.getElementById("closeModal").addEventListener("click",()=>{
  document.getElementById("modal").style.display="none";
});

document.getElementById("copyBtn").addEventListener("click",async()=>{
  await navigator.clipboard.writeText(buildList());
  alert("Copié !");
});

document.getElementById("shareBtn").addEventListener("click",async()=>{
  const txt=buildList();
  if(navigator.share){
    try{ await navigator.share({title:"Liste",text:txt}); }catch(e){}
  }else{
    await navigator.clipboard.writeText(txt);
    alert("Liste copiée !");
  }
});

renderCategories();
</script>

</body>
</html>
